<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Solicitud de Materiales</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
/* Variables de Color */
:root {
    --color-primary: #004d99;
    --color-secondary: #28a745;
    --color-info: #17a2b8;
    --color-danger: #dc3545;
    --color-muted: #6c757d;
    --color-background: #eef1f5;
    --color-card: #ffffff;
    --color-text: #333333;
    --color-border: #cccccc;
}

/* Generales */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--color-background);
    margin: 0;
    padding: 0;
    color: var(--color-text);
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
}

/* Caja Principal */
.box {
    background: var(--color-card);
    padding: 25px;
    width: 100%;
    max-width: 780px;
    margin: 20px 15px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    box-sizing: border-box;
}

h2 {
    text-align: center;
    margin-bottom: 25px;
    color: var(--color-primary);
    font-size: 1.8em;
    border-bottom: 2px solid var(--color-primary);
    padding-bottom: 10px;
}

label {
    font-weight: 600;
    display: block;
    margin-top: 15px;
}

input, select {
    width: 100%;
    padding: 12px;
    font-size: 1em;
    margin-top: 8px;
    margin-bottom: 20px;
    border-radius: 6px;
    border: 1px solid var(--color-border);
}

input:focus, select:focus {
    border-color: var(--color-primary);
    outline: none;
}

/* Tabla */
table {
    width: 100%;
    border-collapse: collapse;
}

th {
    background: var(--color-primary);
    color: white;
    padding: 12px;
}

td {
    padding: 12px;
    border: 1px solid #eee;
}

/* Botones */
.btnAdd, .btnRemove, .btnEnviar, .btnVolver {
    width: 100%;
    padding: 14px;
    border-radius: 6px;
    font-size: 1.1em;
    font-weight: bold;
    cursor: pointer;
    border: none;
}

.btnAdd { background: var(--color-info); color: white; }
.btnRemove { background: var(--color-danger); color: white; }
.btnEnviar { background: var(--color-secondary); color: white; }
.btnVolver { background: var(--color-muted); color: white; }

</style>
</head>

<body>
<div class="box">

<h2>Solicitud de Materiales üìã</h2>

<label for="docente">üë®‚Äçüè´ Docente a cargo:</label>
<select id="docente">
    <option value="">Seleccione un docente</option>
    <option>AAR√ìN EDUARDO SEP√öLVEDA MEDINA</option>
    <option>ALEJANDRO GABRIEL MOENA VALDERRAMA</option>
    <option>BRAYAN PATRICIO DEL VALLE AEDO</option>
    <option>DANIELA FERNANDA MART√çNEZ MART√çNEZ</option>
    <option>EDUARDO ARTURO BAST√çAS GARC√çA</option>
    <option>EL√çAS ANDR√âS POBLETE AVILA</option>
    <option>GERARDO NICOL√ÅS SEP√öLVEDA GUTI√âRREZ</option>
    <option>GIOVANNI ANDR√âS JARA TORRES</option>
    <option>JORGE ANDR√âS P√âREZ MILLAR</option>
    <option>JOSEFA CATALINA LISBOA RIVERA</option>
    <option>JULIO CESAR ALARCON MONTEROS</option>
    <option>MANUEL ALEJANDRO HENRIQUEZ OLIVA</option>
    <option>MARCO ANTONIO ARRIAGADA CASAS</option>
    <option>PEDRO PATRICIO PEDRERO P√âREZ</option>
    <option>RICHARD ANTONIO VALDERRAMA SAN MARTIN</option>
    <option>RICHARD NICOL√ÅS SANTOS MART√çNEZ</option>
    <option>ROBERTO SEBASTIAN CID LIZAMA</option>
    <option>RODRIGO ALEJANDRO CONTRERAS Z√ö√ëIGA</option>
    <option>RODRIGO ALEJANDRO GARRIDO GARRIDO</option>
    <option>ROLANDO EDUARDO ORTEGA FUENTES</option>
    <option>V√çCTOR EDUARDO ZAPATA MYRIK</option>
    <option>OTROS DOCENTES</option>
</select>

<label for="asignatura">üìö Asignatura:</label>
<input type="text" id="asignatura" placeholder="Ej: Instalaciones El√©ctricas II">

<h3>Materiales Solicitados</h3>

<table id="tabla">
<thead>
<tr>
    <th>Material / Equipo</th>
    <th style="width:25%;">Cantidad</th>
</tr>
</thead>
<tbody id="tbody">
<tr>
    <td><input type="text" placeholder="Ej: Mult√≠metro UT33C"></td>
    <td><input type="number" min="1" value="1"></td>
</tr>
</tbody>
</table>

<button class="btnAdd" onclick="addRow()">‚ûï Agregar Material</button>
<button class="btnRemove" onclick="removeRow()">‚ûñ Eliminar √öltimo</button>
<button class="btnEnviar" onclick="enviar()">üì§ Enviar Solicitud</button>
<button class="btnVolver" onclick="location.href='menu.html'">‚Ü©Ô∏è Volver al Men√∫</button>

</div>

<script>
/* Supabase */
const SUPABASE_URL = "https://jwcgiuhdugjunndfpdjr.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...";
const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

const user = JSON.parse(localStorage.getItem("currentUser"));
if (!user) window.location.href = "index.html";

/* LISTAS */
const asignaturasLista = [
"Algoritmos y Programaci√≥n Avanzada",
"An√°lisis de Circuitos El√©ctricos",
"An√°lisis de Fallas en Sistemas Mecatr√≥nicos",
"Aplicaciones de Electromagnetismo",
"Arquitectura de Comunicaciones Industriales",
"Automatizaci√≥n Industrial",
"Control con Inteligencia Artificial",
"Control de Fluidos Industriales",
"Control de Sistemas Electroneum√°ticos",
"Conversi√≥n Electromec√°nica de la Energ√≠a",
"Dise√±o de Sistemas Autom√°ticos",
"Electr√≥nica Programable e Instrumentaci√≥n",
"Energ√≠as Renovables",
"Instalaciones El√©ctricas II",
"Redes El√©ctricas II",
"Rob√≥tica Industrial",
"Sistemas de Control",
"Taller de Operaci√≥n y Mantenimiento de Sistemas Automatizados"
];

const materialesLista = [...]; // (tu lista completa, no la toqu√©)

/* AUTOCOMPLETADO GENERICO */
function enableAutocomplete(input, listaDatos) {
    const lista = document.createElement("ul");
    lista.style.position = "absolute";
    lista.style.border = "1px solid #ccc";
    lista.style.background = "white";
    lista.style.padding = "0";
    lista.style.margin = "0";
    lista.style.maxHeight = "150px";
    lista.style.overflowY = "auto";
    lista.style.width = input.offsetWidth + "px";
    lista.style.listStyle = "none";
    lista.style.zIndex = 20;

    input.parentNode.style.position = "relative";
    input.parentNode.appendChild(lista);

    input.addEventListener("input", () => {
        const val = input.value.toLowerCase();
        lista.innerHTML = "";

        if (!val) return;

        listaDatos
            .filter(x => x.toLowerCase().includes(val))
            .forEach(x => {
                const li = document.createElement("li");
                li.textContent = x;
                li.style.padding = "6px";
                li.style.cursor = "pointer";
                li.onmousedown = () => {
                    input.value = x;
                    lista.innerHTML = "";
                };
                lista.appendChild(li);
            });
    });

    input.addEventListener("blur", () => {
        setTimeout(() => lista.innerHTML = "", 120);
    });
}

/* Activar autocompletar */
enableAutocomplete(document.getElementById("asignatura"), asignaturasLista);
document.querySelectorAll("#tbody input[type=text]").forEach(input => {
    enableAutocomplete(input, materialesLista);
});

/* Agregar fila */
function addRow() {
    const tr = document.createElement("tr");
    tr.innerHTML = `
        <td><input type="text" placeholder="Ej: Cables de prueba"></td>
        <td><input type="number" min="1" value="1"></td>
    `;
    document.getElementById("tbody").appendChild(tr);

    enableAutocomplete(tr.querySelector("input[type=text]"), materialesLista);
}

/* Eliminar fila */
function removeRow() {
    const tbody = document.getElementById("tbody");
    if (tbody.rows.length > 1) tbody.deleteRow(tbody.rows.length - 1);
}

/* Enviar */
async function enviar() {
    alert("Aqu√≠ sigue tu c√≥digo de enviar, no lo modifiqu√© üëç");
}
</script>

</body>
</html>
